syntax = "proto3";
option go_package = "/gen";

message VoteRequest {
  string Id = 1;
  int32 Term = 2;
  string CandidateName = 3;
  int32 LastLogIndex = 4;
  int32 LastLogTerm = 5;
}

message VoteReply {
  string Id = 1;
  bool VoteGranted = 2;
  string CandidateName = 3;
  int32 Term = 4;
}

message Command {

}

message LogEntry {
  int32 Term = 1;
  int32 Index = 2;
  Command Command = 3;
}

message AppendEntryRequest {
  string Id = 1;
  int32 Term = 2;
  string LeaderName = 3;
  int32 PrevLogIndex = 4;
  int32 PrevLogTerm = 5;
  repeated LogEntry Entries = 6;
  int32 LeaderCommit = 7;
}

message AppendEntryReply {
  string Id = 1;
  int32 Term = 2;
  bool Success = 3;
}

message Peer {
  string name = 1;
  string address = 2;
  int32  port = 3;
}

message NewPeerRequest {
  string Id = 1;
  Peer NewPeer = 2;
}

message NewPeerReply {
  string Id = 1;
}

service YadosService {
  rpc RequestVotes(VoteRequest) returns (VoteReply) {}
  rpc AppendEntries(AppendEntryRequest) returns (AppendEntryReply) {}
  rpc AddMember(NewPeerRequest) returns (NewPeerReply) {}
}
